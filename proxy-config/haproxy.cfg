# TCP frontend for native ClickHouse protocol
frontend clickhouse_tcp
    bind *:9000
    mode tcp
    default_backend clickhouse_tcp_nodes

backend clickhouse_tcp_nodes
    mode tcp
    balance roundrobin
    option tcp-check
    tcp-check connect
    server ch1 clickhouse-node1:9000 check
    server ch2 clickhouse-node3:9000 check

# HTTP frontend for ClickHouse's HTTP interface
frontend clickhouse_http
    bind *:8123
    mode http
    default_backend clickhouse_http_nodes

backend clickhouse_http_nodes
    mode http
    balance roundrobin
    option httpchk GET /ping
    server ch1 clickhouse-node1:8123 check
    server ch2 clickhouse-node3:8123 check
